<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>BFS Interior Door Takeoff</title>

<style>

/* ===== Basic Reset ===== */
* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}
body {
  font-family: Arial, Helvetica, sans-serif;
  background: #f4f4f4;
  padding: 20px;
  color: #222;
}

/* ===== Container ===== */
.container {
  max-width: 900px;
  margin: 0 auto 50px auto;
  background: #fff;
  padding: 20px;
  border-radius: 8px;
  box-shadow: 0 2px 4px #0002;
}

/* ===== Headings ===== */
h1, h2, h3 {
  margin-bottom: 16px;
  font-weight: 700;
  color: #003366;
}

.section-title {
  margin-top: 40px;
  margin-bottom: 6px;
  padding: 8px 12px;
  background: #003366;
  color: #fff;
  border-radius: 5px 5px 0 0;
  font-size: 1.1rem;
}

label {
  font-size: 0.95rem;
  font-weight: 600;
  display: inline-block;
  margin: 12px 0 6px 0;
}
input[type="text"], textarea {
  width: 100%;
  padding: 8px 10px;
  border: 1px solid #ccc;
  border-radius: 5px;
  margin-bottom: 12px;
  font-size: 1rem;
}

/* ===== Tables ===== */
table {
  width: 100%;
  border-collapse: collapse;
  margin-bottom: 20px;
  font-size: 0.95rem;
}

th, td {
  padding: 6px 8px;
  border: 1px solid #ccc;
  text-align: center;
}

table thead th {
  position: sticky;
  top: 0;
  z-index: 3;
  background: #fafafa;
}
table .subhdr th {
  position: sticky;
  top: 28px;
  z-index: 2;
  background: #f0f0f0;
}

/* ===== Buttons ===== */
:root {
  --btn-size: 34px;
  --btn-font: 16px;
  --btn-pad-y: 6px;
  --btn-pad-x: 8px;
  --qty-min: 16px;
}

.btn {
  background: #003366;
  color: #fff;
  border: none;
  border-radius: 4px;
  padding: var(--btn-pad-y) var(--btn-pad-x);
  font-size: var(--btn-font);
  cursor: pointer;
  min-width: var(--btn-size);
  min-height: var(--btn-size);
}
.btn:hover { background: #0055a5; }
.btn:active { background: #001f3d; }

.btnrow {
  display: flex;
  flex-wrap: nowrap;
  gap: 8px;
  justify-content: center;
  align-items: center;
}

.qty {
  font-size: 14px;
  min-width: var(--qty-min);
}

/* Reset button */
#resetBtn {
  background: #cc0000;
}
#resetBtn:hover {
  background: #e60000;
}

/* LH / RH background colors */
th.lh-group, td.lh-group {
  background: #eaf3ff !important;
}
th.rh-group, td.rh-group {
  background: #fff2d9 !important;
}
th.lh-end, td.lh-end {
  border-right: 4px solid #111 !important;
}

@media (max-width: 600px) {
  :root {
    --btn-size: 30px;
    --btn-font: 15px;
    --btn-pad-y: 4px;
    --btn-pad-x: 6px;
    --qty-min: 14px;
  }
}

</style>
</head>

<body>
<div class="container">

<h1>BFS Interior Door Takeoff</h1>

<!-- ===== TOP SECTION — Customer & Lot ONLY ===== -->
<label for="customer">Customer:</label>
<input type="text" id="customer" placeholder="Enter customer name" />

<label for="lot">Lot #:</label>
<input type="text" id="lot" placeholder="Enter lot number" />


<!-- ===== DOOR TABLES WILL BE INSERTED HERE BY JS ===== -->

<!-- THE NOTES & SUMMARY SECTION WILL BE MOVED TO BOTTOM -->


<!-- ================= JS START ================= -->
<script>

/* =======================================================
   =============== STATE MANAGEMENT ======================
   ======================================================= */

let state = {};
if (localStorage.getItem('BFSdoorState')) {
  try { state = JSON.parse(localStorage.getItem('BFSdoorState')); }
  catch(e) { state = {}; }
}

function save() {
  localStorage.setItem('BFSdoorState', JSON.stringify(state));
}

function resetAll() {
  state = {};
  document.getElementById("customer").value = "";
  document.getElementById("lot").value = "";
  document.getElementById("notes").value = "";
  document.getElementById("summaryText").value = "";
  save();
  render();
}

function bump(key, delta) {
  state[key] = Math.max(0, (state[key] || 0) + delta);
  save();
  render();
}

function kSingle(height, width, hand, type) {
  return `${height}_${width}_${hand}_${type}`;
}
function kDouble(group, size, hand, type) {
  return `${group}_${size}_${hand}_${type}`;
}

function cellButtons(key) {
  return `
    <div class="btnrow">
      <button class="btn" onclick="bump('${key}', -1)">–</button>
      <div class="qty">${state[key] || 0}</div>
      <button class="btn" onclick="bump('${key}', 1)">+</button>
    </div>
  `;
}


/* =======================================================
   =============== RENDER SECTIONS ========================
   ======================================================= */

function renderSingles(height, widths) {
  let html = `
    <div class="section-title">Door ${height}</div>
    <table>
      <thead>
        <tr>
          <th style="width:60px;">Size</th>
          <th colspan="2" class="lh-group lh-end">LH</th>
          <th colspan="2" class="rh-group">RH</th>
        </tr>
        <tr class="subhdr">
          <th></th>
          <th class="lh-group lh-end">Unit</th>
          <th class="lh-group lh-end">Slab</th>
          <th class="rh-group">Unit</th>
          <th class="rh-group">Slab</th>
        </tr>
      </thead>
      <tbody>
  `;

  widths.forEach(w => {
    html += `
      <tr>
        <td>${w}</td>
        <td class="lh-group lh-end">${cellButtons(kSingle(height, w, "LH", "unit"))}</td>
        <td class="lh-group lh-end">${cellButtons(kSingle(height, w, "LH", "slab"))}</td>
        <td class="rh-group">${cellButtons(kSingle(height, w, "RH", "unit"))}</td>
        <td class="rh-group">${cellButtons(kSingle(height, w, "RH", "slab"))}</td>
      </tr>
    `;
  });

  html += `</tbody></table>`;
  return html;
}


function renderDoubles(group, sizes) {
  let html = `
    <div class="section-title">${group}</div>
    <table>
      <thead>
        <tr>
          <th style="width:60px;">Size</th>
          <th class="lh-group">Unit</th>
          <th class="rh-group">French</th>
        </tr>
      </thead>
      <tbody>
  `;

  sizes.forEach(size => {
    html += `
      <tr>
        <td>${size}</td>
        <td class="lh-group">${cellButtons(kDouble(group, size, "NA", "unit"))}</td>
        <td class="rh-group">${cellButtons(kDouble(group, size, "NA", "french"))}</td>
      </tr>
    `;
  });

  html += `</tbody></table>`;
  return html;
}


function renderTastDoubles(sizes) {
  let html = `
    <div class="section-title">T-Astragal</div>
    <table>
      <thead>
        <tr>
          <th style="width:60px;">Size</th>
          <th colspan="2" class="lh-group lh-end">LH</th>
          <th colspan="2" class="rh-group">RH</th>
        </tr>
        <tr class="subhdr">
          <th></th>
          <th class="lh-group lh-end">Unit</th>
          <th class="lh-group lh-end">French</th>
          <th class="rh-group">Unit</th>
          <th class="rh-group">French</th>
        </tr>
      </thead>
      <tbody>
  `;

  sizes.forEach(size => {
    html += `
      <tr>
        <td>${size}</td>
        <td class="lh-group lh-end">${cellButtons(kDouble("T-Astragal", size, "LH", "unit"))}</td>
        <td class="lh-group lh-end">${cellButtons(kDouble("T-Astragal", size, "LH", "french"))}</td>
        <td class="rh-group">${cellButtons(kDouble("T-Astragal", size, "RH", "unit"))}</td>
        <td class="rh-group">${cellButtons(kDouble("T-Astragal", size, "RH", "french"))}</td>
      </tr>
    `;
  });

  html += `</tbody></table>`;
  return html;
}


/* =======================================================
   ================= SUMMARY GENERATION ===================
   ======================================================= */

function generateSummary() {
  let cust = document.getElementById("customer").value;
  let lot = document.getElementById("lot").value;
  let notes = document.getElementById("notes").value;

  let s = `Customer: ${cust}\nLot #: ${lot}\n\n`;

  Object.keys(state).forEach(k => {
    if (state[k] > 0) s += `${k}: ${state[k]}\n`;
  });

  if (notes.trim() !== "") {
    s += `\nNOTES:\n${notes}\n`;
  }

  document.getElementById("summaryText").value = s;
}


/* =======================================================
   ===================== RENDER PAGE ======================
   ======================================================= */

function render() {
  let root = document.querySelector(".container");

  let content = `
    <h1>BFS Interior Door Takeoff</h1>

    <label for="customer">Customer:</label>
    <input type="text" id="customer" placeholder="Enter customer name" value="${document.getElementById("customer")?.value || ''}" />

    <label for="lot">Lot #:</label>
    <input type="text" id="lot" placeholder="Enter lot number" value="${document.getElementById("lot")?.value || ''}" />

    ${renderSingles("6/8", ["1/6","2/0","2/4","2/6","2/8","3/0"])}
    ${renderSingles("8/0", ["1/6","2/0","2/4","2/6","2/8","3/0"])}
    ${renderDoubles("DBL", ["3/0","4/0","5/0"])}
    ${renderTastDoubles(["3/0","4/0","5/0"])}

    <label for="notes">Notes (field):</label>
    <textarea id="notes" rows="3">${document.getElementById("notes")?.value || ''}</textarea>

    <button id="generateBtn" class="btn" onclick="generateSummary()">Generate Summary Text</button>

    <label for="summaryText">Summary Text (copy/paste):</label>
    <textarea id="summaryText" rows="8">${document.getElementById("summaryText")?.value || ''}</textarea>

    <button id="resetBtn" class="btn" onclick="resetAll()">Reset All</button>
  `;

  root.innerHTML = content;
}

render();

</script>

</div>
</body>
</html>
